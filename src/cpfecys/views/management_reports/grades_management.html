{{extend 'template.html'}}
<!-- Additional Scripts for MARKMIN -->
<script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script>
<script type="text/javascript" src="{{=URL('static','markitup')}}/jquery.markitup.pack.js"></script>
<script type="text/javascript" src="{{=URL('static','markitup')}}/sets/markmin/set.js"></script>
<script type="text/javascript" src="{{=URL('static','js')}}/highcharts/js/highcharts.js"></script>
<script type="text/javascript" src="{{=URL('static','js')}}/highcharts/js/modules/data.js"></script>
<script type="text/javascript" src="{{=URL('static','js')}}/highcharts/js/modules/exporting.js"></script>
<link rel="stylesheet" type="text/css" href="{{=URL('static','markitup')}}/skins/markitup/style.css"/>
<link rel="stylesheet" type="text/css" href="{{=URL('static','markitup')}}/sets/markmin/style.css"/>
<!-- //Additional Scripts for MARKMIN -->
<div id='as' class="row-fluid container" style="overflow:auto; width:100%;">
    <!--Search in report-->
    <div class="noPrint">
    	<div>
    		{{if request.vars['level'] is None or str(request.vars['level'])=="1":}}
				<form action="{{=URL('management_reports', 'grades_management/search')}}" method="post">
			{{elif str(request.vars['level'])=="2":}}
				<form action="{{=URL('management_reports', 'grades_management/search', vars=dict(level = 2, period = request.vars['period'], type_L=request.vars['type_L']))}}" method="post">
			{{elif str(request.vars['level'])=="3":}}
				<form action="{{=URL('management_reports', 'grades_management/search', vars=dict(level = 3, period = request.vars['period'], month = str(request.vars['month']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}" method="post">
			{{elif str(request.vars['level'])=="4":}}
				<form action="{{=URL('management_reports', 'grades_management/search', vars=dict(level = 4, period = request.vars['period'], month = str(request.vars['month']), project = str(request.vars['project']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}" method="post">
			{{elif str(request.vars['level'])=="5":}}
				<form action="{{=URL('management_reports', 'grades_management/search', vars=dict(level = 5, period = request.vars['period'], month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}" method="post">
			{{elif str(request.vars['level'])=="6":}}
				<form action="{{=URL('management_reports', 'grades_management/search', vars=dict(level = 6, period = request.vars['period'], month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), userP = str(request.vars['userP']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}" method="post">
			{{pass}}
				<input type="text" id="querySearch" name="querySearch" value="{{=personal_query}}" readonly="readonly"/>
				<a id="buildSearch" class="btn">{{=T('Build Search')}}</a>
				<button type="submit"  class="btn">{{=T('Search')}}</button>
				<a id="cancelSearch" class="btn">{{=T('Clear')}}</a>
			</form>
		</div>
		<div id="div_search" style="display: none;">
			<table>
				<tr>
					<td>
						<select class="generic-widget" id="fieldSearch">
						{{for field in fsearch:}}
							<option value="grades_log.{{=str(field[0])}}">{{=str(field[1])}}</option>
						{{pass}}
						</select>
					</td>
					<td>
						{{conadorF=0}}
						{{for field in fsearch:}}
							{{if conadorF==0:}}
								<select class="generic-widget" id="optionSearch_{{=str(field[0])}}">
							{{else:}}
								<select class="generic-widget" id="optionSearch_{{=str(field[0])}}" style="display:none;">
							{{pass}}
							{{for option in (filtered_by(field[2])):}}
								<option value="{{=str(option[0])}}">{{=str(option[1])}}</option>
							{{pass}}
							</select>
							{{conadorF+=1}}
						{{pass}}
					</td>
					<td>
						{{conadorF=0}}
						{{for field in fsearch:}}
							{{if field[3][0]==1:}}
								{{if conadorF==0:}}
									<input id="value_{{=str(field[0])}}" type="text" />
								{{else:}}
									<input id="value_{{=str(field[0])}}" type="text" style="display:none;"/>
								{{pass}}
							{{elif field[3][0]==2:}}
								{{if conadorF==0:}}
									<input id="value_{{=str(field[0])}}" class="datetime" placeholder="YYYY-MM-DD HH:MM:SS" type="text" value = ""/>
								{{else:}}
									<input id="value_{{=str(field[0])}}" class="datetime" placeholder="YYYY-MM-DD HH:MM:SS" type="text" value = "" style="display:none;"/>
								{{pass}}
							{{pass}}
							{{conadorF+=1}}
						{{pass}}
					</td>
					<td>
						<a id="newSearch" class="btn" title="{{=T('Start building a new search')}}">{{=T('New Search')}}</a>
					</td>
					<td>
						<a id="andSearch" class="btn" title="{{=T('Add this to the search as an AND term')}}">{{=T('+ And')}}</a>
					</td>
					<td>
						<a id="orSearch" class="btn" title="{{=T('Add this to the search as an OR term')}}">{{=T('+ Or')}}</a>
					</td>
					<td>
						<a id="closeSearch" class="btn">{{=T('Close')}}</a>
					</td>
				</tr>
			</table>
		</div>
	</div>
    <!--Search in report-->
    <!--REPORT CONTENTS-->
    <div>
    	<center><h1>{{=T('Report Summary')}}</h1></center>
    {{if request.vars['level'] is None or str(request.vars['level'])=="1":}}
    	<table class="table">
    		<tr>
    			<td>
			    	<div class="span10">
						<div class="span6">
			    			<strong>{{=T('Type')}}: </strong> {{=T('Grades Management')}}<br/>
				    		<strong>{{=T('Description')}}: </strong> {{=T('Report of transactions on the notes of students')}}<br/>
				    		<a class="noPrint" href="{{=URL('management_reports','grades_management_export', vars=dict(list_type='csv', level='1', querySearch=personal_query))}}" title="{{=T('Export reporting level')}}"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				    		<a class="btn noPrint" onclick="noPrint();"><i class="icon-print"></i></a>
						</div>
						<div class="span1 center"></div>
					    <div class="span5 center">
					    	<div style="width:100%; height:300px;" id="graphbars"></div>
					    	<script type="text/javascript">
			                    $(function () {
			                        $('#graphbars').highcharts({
			                            chart: {
			                                type: 'column',
			                                margin: [ 50, 50, 100, 80]
			                            },
			                            title: {
			                                text: '{{=T("TOP 5: Semesters more operations grades")}}'
			                            },
			                            xAxis: {
			                                categories: [
			                                	{{for top in top5:}}
			                                	'{{=top["grades_log.period"]}} {{=top["grades_log.yearp"]}}',
			                                	{{pass}}
			                                ],
			                                labels: {
			                                    rotation: -45,
			                                    align: 'right',
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif'
			                                    }
			                                }
			                            },
			                            yAxis: {
			                                min: 0,
			                                title: {
			                                    text: '{{=T("Operations")}}'
			                                }
			                            },
			                            legend: {
			                                enabled: false
			                            },
			                            tooltip: {
			                                pointFormat: '{{=T("Operations")}}: <b>{point.y:.1f}</b>',
			                            },
			                            series: [{
			                                name: '{{=T("Operations")}}',
			                                data: [
			                                       	{{for top in top5:}}
										    			{{=top['COUNT(grades_log.id)']}},
				                                	{{pass}}
			                                       ],
			                                dataLabels: {
			                                    enabled: true,
			                                    rotation: -90,
			                                    color: '#FFFFFF',
			                                    align: 'right',
			                                    x: 4,
			                                    y: 10,
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif',
			                                        textShadow: '0 0 3px black'
			                                    }
			                                }
			                            }]
			                        });
			                    });
			                </script>
					    </div>
			    	</div>
				</td>
    		</tr>
    	</table>
    	<div class="navbar">
	      <div class="navbar-inner">
	      	<center><h1>{{=T('Detail')}}</h1></center>
	      	<a id="visibleAll" role="button" style="cursor:pointer;" class="pull-right"> 
	    		<span class="icon-black icon-plus-sign"></span>&nbsp;{{=T('Show All')}}
	    	</a>
	    	<a id="novisibleAll" role="button" style="cursor:pointer; display:none;" class="pull-right"> 
	    		<span class="icon-black icon-minus-sign"></span>&nbsp;{{=T('False')}} {{=T('Show All')}}
	    	</a>
	      </div>
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<h1>{{=T('Detail')}}</h1>
	  	</div>
    	<table class="table table-striped table-bordered">
		{{for period in infoLevel:}}
		{{if float(int(period[2])+int(period[3])+int(period[4]))>float(0):}}
			<tr>
		{{else:}}
			<tr class="noVisible" style="display:none;">
		{{pass}}
			<td>
				<h1><small>{{=period[1]}}</small></h1>
				<div class="span10" align="center">
					<div class="span6">
						<table class="table table-striped table-bordered">
							<tr>
								<th><center>{{=T('Total inserted')}}</center></th>
								<td>
									<center><a class="badge badge-success noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = period[0], level='2', type_L = 'i', querySearch=personal_query))}}">{{=period[2]}}</a>
									<a class="badge badge-success yesPrint" style="white-space:nowrap; display:none;">{{=period[2]}}</a></center>
								</td>
							</tr>
							<tr>
								<th><center>{{=T('Total modified')}}</center></th>
								<td>
									<center><a class="badge badge-info noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = period[0], level='2', type_L = 'u', querySearch=personal_query))}}">{{=period[3]}}</a>
									<a class="badge badge-info yesPrint" style="white-space:nowrap; display:none;">{{=period[3]}}</a></center>
								</td>
							</tr>
							<tr>
								<th><center>{{=T('Total out')}}</center></th>
								<td>
									<center><a class="badge badge-important noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = period[0], level='2', type_L = 'd', querySearch=personal_query))}}">{{=period[4]}}</a>
									<a class="badge badge-important yesPrint" style="white-space:nowrap; display:none;">{{=period[4]}}</a></center>
								</td>
							</tr>
						</table>
						<center>
							<a class="btn noPrint" style="white-space:nowrap; cursor:pointer;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = period[0], level='2', type_L = 'all', querySearch=personal_query))}}"><b>{{=T('See')}} {{=T('Area Level')}} </b><span class="icon-black icon-arrow-right"></span></a>
						</center>
						<br><br>
		    		</div>
		    		<div class="span1 center"></div>
		    		<div class="span5 center">
		    			{{if float(int(period[2])+int(period[3])+int(period[4]))>float(0):}}
		    				<div style="width:100%; height:300px;" id="graphpie{{=period[0]}}"></div>
		    				<script type="text/javascript">
					                    $(function () {
					                        $('#graphpie{{=period[0]}}').highcharts({
					                            chart: {
					                                plotBackgroundColor: null,
					                                plotBorderWidth: null,
					                                plotShadow: false
					                            },
					                            title: {
					                                text: '{{=T("Operations on academic grades")}}'
					                            },
					                            tooltip: {
					                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					                            },
					                            plotOptions: {
					                                pie: {
					                                    allowPointSelect: true,
					                                    cursor: 'pointer',
					                                    dataLabels: {
					                                        enabled: true,
					                                        color: '#000000',
					                                        connectorColor: '#000000',
					                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
					                                    }
					                                }
					                            },
					                            series: [{
					                                type: 'pie',
					                                name: '{{=T("Percentage of operation")}}',
					                                data: [
					                                    ['{{=T("Modified")}}',   {{=(100*float(period[3]))/float(int(period[2])+int(period[3])+int(period[4]))}}],
					                                    ['{{=T("Out")}}',   {{=(100*float(period[4]))/float(int(period[2])+int(period[3])+int(period[4]))}}],
					                                    ['{{=T("Inserted")}}',   {{=(100*float(period[2]))/float(int(period[2])+int(period[3])+int(period[4]))}}]
					                                ]
					                            }]
					                        });
					                    });
					                </script>
		    			{{else:}}
		    				<h1>{{=T('No visible graphic')}}</h1>
		    			{{pass}}
		    			<br>
		    		</div>
				</div>
			</td>
		</tr>
		{{pass}}
		</table>
    {{elif str(request.vars['level'])=="2":}}
    	<table class="table">
    		<tr>
    			<td>
			    	<div class="span10">
						<div class="span6">
			    			<a style="white-space:nowrap; cursor:pointer; align:right;" class="btn noPrint" href="{{=URL('management_reports', 'grades_management',vars=dict(querySearch=personal_query))}}"><span class="icon-black icon-arrow-up"></span><b>{{=T('Level Up')}}</b></a>
				    		<br/><br/><br/>
				    		<strong>{{=T('Type')}}: </strong> {{=T('Grades Management')}}<br/>
				    		<strong>{{=T('Description')}}: </strong> {{=T('Report of transactions on the notes of students')}}<br/>
				    		<strong>{{=T('Period')}}: </strong> {{=infoLevel[0][0]}}<br/>
				    		<a class="noPrint" href="{{=URL('management_reports','grades_management_export', vars=dict(list_type='csv', level='2',period = str(request.vars['period']), type_L = str(request.vars['type_L']), querySearch=personal_query))}}" title="{{=T('Export reporting level')}}"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				    		<a class="btn noPrint" onclick="noPrint();"><i class="icon-print"></i></a>
						</div>
						<div class="span1 center"></div>
					    <div class="span5 center">
					    	<div style="width:100%; height:300px;" id="graphbars"></div>
					    	<script type="text/javascript">
			                    $(function () {
			                        $('#graphbars').highcharts({
			                            chart: {
			                                type: 'column',
			                                margin: [ 50, 50, 100, 80]
			                            },
			                            title: {
			                                text: '{{=T("Operations on the grades in the semester")}}'
			                            },
			                            xAxis: {
			                                categories: [
			                                	{{for month in infoLevel:}}
			                                	'{{=month[2]}}',
			                                	{{pass}}
			                                ],
			                                labels: {
			                                    rotation: -45,
			                                    align: 'right',
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif'
			                                    }
			                                }
			                            },
			                            yAxis: {
			                                min: 0,
			                                title: {
			                                    text: '{{=T("Operations")}}'
			                                }
			                            },
			                            legend: {
			                                enabled: false
			                            },
			                            tooltip: {
			                                pointFormat: '{{=T("Operations")}}: <b>{point.y:.1f}</b>',
			                            },
			                            series: [{
			                                name: '{{=T("Operations")}}',
			                                data: [
			                                       	{{for month in infoLevel:}}
			                                       		{{if str(request.vars['type_L'])=="all":}}
										    				{{=int(month[3])+int(month[4])+int(month[5])}},
										    			{{else:}}
										    				{{=int(month[3])}},
										    			{{pass}}
				                                	{{pass}}
			                                       ],
			                                dataLabels: {
			                                    enabled: true,
			                                    rotation: -90,
			                                    color: '#FFFFFF',
			                                    align: 'right',
			                                    x: 4,
			                                    y: 10,
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif',
			                                        textShadow: '0 0 3px black'
			                                    }
			                                }
			                            }]
			                        });
			                    });
			                </script>
					    </div>
			    	</div>
				</td>
    		</tr>
    	</table>
    	<div class="navbar">
	      <div class="navbar-inner">
	      	<center><h1>
	      		<center><h1>{{=T('Detail')}}</h1></center>
	      	</h1></center>
	      	<a id="visibleAll" role="button" style="cursor:pointer;" class="pull-right"> 
	    		<span class="icon-black icon-plus-sign"></span>&nbsp;{{=T('Show All')}}
	    	</a>
	    	<a id="novisibleAll" role="button" style="cursor:pointer; display:none;" class="pull-right"> 
	    		<span class="icon-black icon-minus-sign"></span>&nbsp;{{=T('False')}} {{=T('Show All')}}
	    	</a>
	      </div>
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<h1>{{=T('Detail')}}</h1>
	  	</div>
    	<table class="table table-striped table-bordered">
		{{for month in infoLevel:}}
		{{if str(request.vars['type_L'])=="all":
			totalMonth=float(int(month[3])+int(month[4])+int(month[5]))
		else:
			totalMonth=float(int(month[3]))
		pass}}
		{{if totalMonth>float(0):}}
			<tr>
		{{else:}}
			<tr class="noVisible" style="display:none;">
		{{pass}}
			<td>
				<h1><small>{{=month[2]}}</small></h1>
				<div class="span10" align="center">
					<div class="span6">
						<table class="table table-striped table-bordered">
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="i":}}
							<tr>
								<th><center>{{=T('Total inserted')}}</center></th>
								<td>
									<center><a class="badge badge-success noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= month[1], level='3', type_U = str(request.vars['type_L']), type_L = 'i', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=month[3]
										else:
											=month[3]
										pass
										}}
									</a>
									<a class="badge badge-success yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=month[3]
										else:
											=month[3]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="u":}}
							<tr>
								<th><center>{{=T('Total modified')}}</center></th>
								<td>
									<center><a class="badge badge-info noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= month[1], level='3', type_U = str(request.vars['type_L']), type_L = 'u', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=month[4]
										else:
											=month[3]
										pass
										}}
									</a>
									<a class="badge badge-info yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=month[4]
										else:
											=month[3]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="d":}}
							<tr>
								<th><center>{{=T('Total out')}}</center></th>
								<td>
									<center><a class="badge badge-important noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= month[1], level='3', type_U = str(request.vars['type_L']), type_L = 'd', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=month[5]
										else:
											=month[3]
										pass
										}}
									</a>
									<a class="badge badge-important yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=month[5]
										else:
											=month[3]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
						</table>
						<center>
							<a class="btn noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= month[1], level='3', type_U = str(request.vars['type_L']), type_L = 'all', querySearch=personal_query))}}"><b>{{=T('See')}} {{=T('Area Level')}} </b><span class="icon-black icon-arrow-right"></span></a>
						</center>
						<br><br>
		    		</div>
		    		<div class="span1 center"></div>
		    		<div class="span5 center">
		    			{{if totalMonth>float(0):}}
		    				<div style="width:100%; height:300px;" id="graphpie{{=month[1]}}"></div>
		    				<script type="text/javascript">
					                    $(function () {
					                        $('#graphpie{{=month[1]}}').highcharts({
					                            chart: {
					                                plotBackgroundColor: null,
					                                plotBorderWidth: null,
					                                plotShadow: false
					                            },
					                            title: {
					                                text: '{{=T("Operations on academic grades")}}'
					                            },
					                            tooltip: {
					                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					                            },
					                            plotOptions: {
					                                pie: {
					                                    allowPointSelect: true,
					                                    cursor: 'pointer',
					                                    dataLabels: {
					                                        enabled: true,
					                                        color: '#000000',
					                                        connectorColor: '#000000',
					                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
					                                    }
					                                }
					                            },
					                            series: [{
					                                type: 'pie',
					                                name: '{{=T("Percentage of operation")}}',
					                                data: [
					                                {{if str(request.vars['type_L'])=="all":}}
					                                	['{{=T("Modified")}}', {{=(100*float(month[4]))/totalMonth}}],
					                                    ['{{=T("Out")}}', {{=(100*float(month[5]))/totalMonth}}],
					                                    ['{{=T("Inserted")}}', {{=(100*float(month[3]))/totalMonth}}]
					                                {{elif str(request.vars['type_L'])=="i":}}
					                                	['{{=T("Modified")}}',   {{=0/totalMonth}}],
					                                    ['{{=T("Out")}}',   {{=0/totalMonth}}],
					                                    ['{{=T("Inserted")}}',   {{=(100*float(month[3]))/totalMonth}}]
					                                {{elif str(request.vars['type_L'])=="u":}}
					                                	['{{=T("Modified")}}',   {{=(100*float(month[3]))/totalMonth}}],
					                                    ['{{=T("Out")}}',   {{=0/totalMonth}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totalMonth}}]
					                                {{elif str(request.vars['type_L'])=="d":}}
					                                	['{{=T("Modified")}}',   {{=0/totalMonth}}],
					                                    ['{{=T("Out")}}',   {{=(100*float(month[3]))/totalMonth}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totalMonth}}]
					                                {{pass}}
					                                ]
					                            }]
					                        });
					                    });
					                </script>
		    			{{else:}}
		    				<h1>{{=T('No visible graphic')}}</h1>
		    			{{pass}}
		    			<br>
		    		</div>
				</div>
			</td>
		</tr>
		{{pass}}
		</table>
    {{elif str(request.vars['level'])=="3":}}
    	<table class="table">
    		<tr>
    			<td>
			    	<div class="span10">
						<div class="span6">
			    			<a style="white-space:nowrap; cursor:pointer; align:right;" class="btn noPrint" href="{{=URL('management_reports', 'grades_management',vars=dict(list='level',level='2',period = str(request.vars['period']), type_L = str(request.vars['type_U']), querySearch=personal_query))}}"><span class="icon-black icon-arrow-up"></span><b>{{=T('Level Up')}}</b></a>
				    		<br/><br/><br/>
				    		<strong>{{=T('Type')}}: </strong> {{=T('Grades Management')}}<br/>
				    		<strong>{{=T('Description')}}: </strong> {{=T('Report of transactions on the notes of students')}}<br/>
				    		<strong>{{=T('Period')}}: </strong> {{=infoLevel[0][0]}}<br/>
				    		<strong>{{=T('Month')}}: </strong> {{=infoLevel[0][1]}}<br/>
				    		<a class="noPrint" href="{{=URL('management_reports','grades_management_export', vars=dict(list_type='csv', level='3',period = str(request.vars['period']), month = str(request.vars['month']), type_L = str(request.vars['type_L']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}" title="{{=T('Export reporting level')}}"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				    		<a class="btn noPrint" onclick="noPrint();"><i class="icon-print"></i></a>
						</div>
						<div class="span1 center"></div>
					    <div class="span5 center">
					    	<div style="width:100%; height:300px;" id="graphbars"></div>
					    	<script type="text/javascript">
			                    $(function () {
			                        $('#graphbars').highcharts({
			                            chart: {
			                                type: 'column',
			                                margin: [ 50, 50, 100, 80]
			                            },
			                            title: {
			                                text: '{{=T("TOP 5: Projects more operations grades")}}'
			                            },
			                            xAxis: {
			                                categories: [
			                                	{{for top in top5:}}
			                                	'{{=top["grades_log.project"]}}',
			                                	{{pass}}
			                                ],
			                                labels: {
			                                    rotation: -45,
			                                    align: 'right',
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif'
			                                    }
			                                }
			                            },
			                            yAxis: {
			                                min: 0,
			                                title: {
			                                    text: '{{=T("Operations")}}'
			                                }
			                            },
			                            legend: {
			                                enabled: false
			                            },
			                            tooltip: {
			                                pointFormat: '{{=T("Operations")}}: <b>{point.y:.1f}</b>',
			                            },
			                            series: [{
			                                name: '{{=T("Operations")}}',
			                                data: [
			                                       	{{for top5 in top5:}}
										    			{{=top5['COUNT(grades_log.id)']}},
				                                	{{pass}}
			                                       ],
			                                dataLabels: {
			                                    enabled: true,
			                                    rotation: -90,
			                                    color: '#FFFFFF',
			                                    align: 'right',
			                                    x: 4,
			                                    y: 10,
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif',
			                                        textShadow: '0 0 3px black'
			                                    }
			                                }
			                            }]
			                        });
			                    });
			                </script>
					    </div>
			    	</div>
				</td>
    		</tr>
    	</table>
    	<div class="navbar">
	      <div class="navbar-inner">
	      	<center><h1>
	      		<center><h1>{{=T('Detail')}}</h1></center>
	      	</h1></center>
	      	<a id="visibleAll" role="button" style="cursor:pointer;" class="pull-right"> 
	    		<span class="icon-black icon-plus-sign"></span>&nbsp;{{=T('Show All')}}
	    	</a>
	    	<a id="novisibleAll" role="button" style="cursor:pointer; display:none;" class="pull-right"> 
	    		<span class="icon-black icon-minus-sign"></span>&nbsp;{{=T('False')}} {{=T('Show All')}}
	    	</a>
	      </div>
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<h1>{{=T('Detail')}}</h1>
	  	</div>
    	<table class="table table-striped table-bordered">
    	{{pieGraphP=0}}
		{{for project in infoLevel:}}
		{{pieGraphP+=1}}
		{{if str(request.vars['type_L'])=="all":
			totalProject=float(int(project[4])+int(project[5])+int(project[6]))
		else:
			totalProject=float(int(project[4]))
		pass}}
		{{if totalProject>float(0):}}
			<tr>
		{{else:}}
			<tr class="noVisible" style="display:none;">
		{{pass}}
			<td>
				<h1><small>{{=project[3]}}</small></h1>
				<div class="span10" align="center">
					<div class="span6">
						<table class="table table-striped table-bordered">
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="i":}}
							<tr>
								<th><center>{{=T('Total inserted')}}</center></th>
								<td>
									<center><a class="badge badge-success noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project=project[2], level='4', type_U = str(request.vars['type_L']), type_L = 'i', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=project[4]
										else:
											=project[4]
										pass
										}}
									</a>
									<a class="badge badge-success yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=project[4]
										else:
											=project[4]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="u":}}
							<tr>
								<th><center>{{=T('Total modified')}}</center></th>
								<td>
									<center><a class="badge badge-info noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project=project[2], level='4', type_U = str(request.vars['type_L']), type_L = 'u', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=project[5]
										else:
											=project[4]
										pass
										}}
									</a>
									<a class="badge badge-info yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=project[5]
										else:
											=project[4]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="d":}}
							<tr>
								<th><center>{{=T('Total out')}}</center></th>
								<td>
									<center><a class="badge badge-important noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project=project[2], level='4', type_U = str(request.vars['type_L']), type_L = 'd', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=project[6]
										else:
											=project[4]
										pass
										}}
									</a>
									<a class="badge badge-important yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=project[6]
										else:
											=project[4]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
						</table>
						<center>
							<a class="btn noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project=project[2], level='4', type_U = str(request.vars['type_L']), type_L = 'all', querySearch=personal_query))}}"><b>{{=T('See')}} {{=T('Area Level')}} </b><span class="icon-black icon-arrow-right"></span></a>
						</center>
						<br><br>
		    		</div>
		    		<div class="span1 center"></div>
		    		<div class="span5 center">
		    			{{if totalProject>float(0):}}
		    				<div style="width:100%; height:300px;" id="graphpie{{=str(pieGraphP)}}"></div>
		    				<script type="text/javascript">
					                    $(function () {
					                        $('#graphpie{{=str(pieGraphP)}}').highcharts({
					                            chart: {
					                                plotBackgroundColor: null,
					                                plotBorderWidth: null,
					                                plotShadow: false
					                            },
					                            title: {
					                                text: '{{=T("Operations on academic grades")}}'
					                            },
					                            tooltip: {
					                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					                            },
					                            plotOptions: {
					                                pie: {
					                                    allowPointSelect: true,
					                                    cursor: 'pointer',
					                                    dataLabels: {
					                                        enabled: true,
					                                        color: '#000000',
					                                        connectorColor: '#000000',
					                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
					                                    }
					                                }
					                            },
					                            series: [{
					                                type: 'pie',
					                                name: '{{=T("Percentage of operation")}}',
					                                data: [
					                                {{if str(request.vars['type_L'])=="all":}}
					                                	['{{=T("Modified")}}', {{=(100*float(project[5]))/totalProject}}],
					                                    ['{{=T("Out")}}', {{=(100*float(project[6]))/totalProject}}],
					                                    ['{{=T("Inserted")}}', {{=(100*float(project[4]))/totalProject}}]
					                                {{elif str(request.vars['type_L'])=="i":}}
					                                	['{{=T("Modified")}}',   {{=0/totalProject}}],
					                                    ['{{=T("Out")}}',   {{=0/totalProject}}],
					                                    ['{{=T("Inserted")}}',   {{=(100*float(project[4]))/totalProject}}]
					                                {{elif str(request.vars['type_L'])=="u":}}
					                                	['{{=T("Modified")}}',   {{=(100*float(project[4]))/totalProject}}],
					                                    ['{{=T("Out")}}',   {{=0/totalProject}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totalProject}}]
					                                {{elif str(request.vars['type_L'])=="d":}}
					                                	['{{=T("Modified")}}',   {{=0/totalProject}}],
					                                    ['{{=T("Out")}}',   {{=(100*float(project[4]))/totalProject}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totalProject}}]
					                                {{pass}}
					                                ]
					                            }]
					                        });
					                    });
					                </script>
		    			{{else:}}
		    				<h1>{{=T('No visible graphic')}}</h1>
		    			{{pass}}
		    			<br>
		    		</div>
				</div>
			</td>
		</tr>
		{{pass}}
		</table>
		<div align="right"> {{=T('Count')}} {{=T('Projects')}}: {{=pieGraphP}}</div>
    {{elif str(request.vars['level'])=="4":}}
    	<table class="table">
    		<tr>
    			<td>
			    	<div class="span10">
						<div class="span6">
			    			<a style="white-space:nowrap; cursor:pointer; align:right;" class="btn noPrint" href="{{=URL('management_reports', 'grades_management',vars=dict(list='level',level='3', period = str(request.vars['period']), month = str(request.vars['month']), type_L = str(request.vars['type_U']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}"><span class="icon-black icon-arrow-up"></span><b>{{=T('Level Up')}}</b></a>
				    		<br/><br/><br/>
				    		<strong>{{=T('Type')}}: </strong> {{=T('Grades Management')}}<br/>
				    		<strong>{{=T('Description')}}: </strong> {{=T('Report of transactions on the notes of students')}}<br/>
				    		<strong>{{=T('Period')}}: </strong> {{=infoLevel[0][0]}}<br/>
				    		<strong>{{=T('Month')}}: </strong> {{=infoLevel[0][1]}}<br/>
				    		<strong>{{=T('Project')}}: </strong> {{=infoLevel[0][2]}}<br/>
				    		<a class="noPrint" href="{{=URL('management_reports','grades_management_export', vars=dict(list_type='csv', level='4',period = str(request.vars['period']), month = str(request.vars['month']), project = str(request.vars['project']), type_L = str(request.vars['type_L']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}" title="{{=T('Export reporting level')}}"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				    		<a class="btn noPrint" onclick="noPrint();"><i class="icon-print"></i></a>
						</div>
						<div class="span1 center"></div>
					    <div class="span5 center">
					    	<div style="width:100%; height:300px;" id="graphbars"></div>
					    	<script type="text/javascript">
			                    $(function () {
			                        $('#graphbars').highcharts({
			                            chart: {
			                                type: 'column',
			                                margin: [ 50, 50, 100, 80]
			                            },
			                            title: {
			                                text: '{{=T("Operations on the notes by role")}}'
			                            },
			                            xAxis: {
			                                categories: [
			                                	{{for roll in infoLevel:}}
			                                	'{{=roll[4]}}',
			                                	{{pass}}
			                                ],
			                                labels: {
			                                    rotation: -45,
			                                    align: 'right',
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif'
			                                    }
			                                }
			                            },
			                            yAxis: {
			                                min: 0,
			                                title: {
			                                    text: '{{=T("Operations")}}'
			                                }
			                            },
			                            legend: {
			                                enabled: false
			                            },
			                            tooltip: {
			                                pointFormat: '{{=T("Operations")}}: <b>{point.y:.1f}</b>',
			                            },
			                            series: [{
			                                name: '{{=T("Operations")}}',
			                                data: [
			                                       	{{for roll in infoLevel:}}
			                                       		{{if str(request.vars['type_L'])=="all":}}
										    				{{=int(roll[5])+int(roll[6])+int(roll[7])}},
										    			{{else:}}
										    				{{=int(roll[5])}},
										    			{{pass}}
				                                	{{pass}}
			                                       ],
			                                dataLabels: {
			                                    enabled: true,
			                                    rotation: -90,
			                                    color: '#FFFFFF',
			                                    align: 'right',
			                                    x: 4,
			                                    y: 10,
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif',
			                                        textShadow: '0 0 3px black'
			                                    }
			                                }
			                            }]
			                        });
			                    });
			                </script>
					    </div>
			    	</div>
				</td>
    		</tr>
    	</table>
    	<div class="navbar">
	      <div class="navbar-inner">
	      	<center><h1>
	      		<center><h1>{{=T('Detail')}}</h1></center>
	      	</h1></center>
	      	<a id="visibleAll" role="button" style="cursor:pointer;" class="pull-right"> 
	    		<span class="icon-black icon-plus-sign"></span>&nbsp;{{=T('Show All')}}
	    	</a>
	    	<a id="novisibleAll" role="button" style="cursor:pointer; display:none;" class="pull-right"> 
	    		<span class="icon-black icon-minus-sign"></span>&nbsp;{{=T('False')}} {{=T('Show All')}}
	    	</a>
	      </div>
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<h1>{{=T('Detail')}}</h1>
	  	</div>
    	<table class="table table-striped table-bordered">
    	{{pieGraphR=0}}
		{{for roll in infoLevel:}}
		{{pieGraphR+=1}}
		{{if str(request.vars['type_L'])=="all":
			totalRoll=float(int(roll[5])+int(roll[6])+int(roll[7]))
		else:
			totalRoll=float(int(roll[5]))
		pass}}
		{{if totalRoll>float(0):}}
			<tr>
		{{else:}}
			<tr class="noVisible" style="display:none;">
		{{pass}}
			<td>
				<h1><small>{{=roll[4]}}</small></h1>
				<div class="span10" align="center">
					<div class="span6">
						<table class="table table-striped table-bordered">
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="i":}}
							<tr>
								<th><center>{{=T('Total inserted')}}</center></th>
								<td>
									<center><a class="badge badge-success noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll=roll[3], level='5', type_U = str(request.vars['type_L']), type_L = 'i', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=roll[5]
										else:
											=roll[5]
										pass
										}}
									</a>
									<a class="badge badge-success yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=roll[5]
										else:
											=roll[5]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="u":}}
							<tr>
								<th><center>{{=T('Total modified')}}</center></th>
								<td>
									<center><a class="badge badge-info noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll=roll[3], level='5', type_U = str(request.vars['type_L']), type_L = 'u', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=roll[6]
										else:
											=roll[5]
										pass
										}}
									</a>
									<a class="badge badge-info yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=roll[6]
										else:
											=roll[5]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="d":}}
							<tr>
								<th><center>{{=T('Total out')}}</center></th>
								<td>
									<center><a class="badge badge-important noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll=roll[3], level='5', type_U = str(request.vars['type_L']), type_L = 'd', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=roll[7]
										else:
											=roll[5]
										pass
										}}
									</a>
									<a class="badge badge-important yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=roll[7]
										else:
											=roll[5]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
						</table>
						<center>
							<a class="btn noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll=roll[3], level='5', type_U = str(request.vars['type_L']), type_L = 'all', querySearch=personal_query))}}"><b>{{=T('See')}} {{=T('Area Level')}} </b><span class="icon-black icon-arrow-right"></span></a>
						</center>
						<br><br>
		    		</div>
		    		<div class="span1 center"></div>
		    		<div class="span5 center">
		    			{{if totalRoll>float(0):}}
		    				<div style="width:100%; height:300px;" id="graphpie{{=pieGraphR}}"></div>
		    				<script type="text/javascript">
					                    $(function () {
					                        $('#graphpie{{=pieGraphR}}').highcharts({
					                            chart: {
					                                plotBackgroundColor: null,
					                                plotBorderWidth: null,
					                                plotShadow: false
					                            },
					                            title: {
					                                text: '{{=T("Operations on academic grades")}}'
					                            },
					                            tooltip: {
					                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					                            },
					                            plotOptions: {
					                                pie: {
					                                    allowPointSelect: true,
					                                    cursor: 'pointer',
					                                    dataLabels: {
					                                        enabled: true,
					                                        color: '#000000',
					                                        connectorColor: '#000000',
					                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
					                                    }
					                                }
					                            },
					                            series: [{
					                                type: 'pie',
					                                name: '{{=T("Percentage of operation")}}',
					                                data: [
					                                {{if str(request.vars['type_L'])=="all":}}
					                                	['{{=T("Modified")}}', {{=(100*float(roll[6]))/totalRoll}}],
					                                    ['{{=T("Out")}}', {{=(100*float(roll[7]))/totalRoll}}],
					                                    ['{{=T("Inserted")}}', {{=(100*float(roll[5]))/totalRoll}}]
					                                {{elif str(request.vars['type_L'])=="i":}}
					                                	['{{=T("Modified")}}',   {{=0/totalRoll}}],
					                                    ['{{=T("Out")}}',   {{=0/totalRoll}}],
					                                    ['{{=T("Inserted")}}',   {{=(100*float(roll[5]))/totalRoll}}]
					                                {{elif str(request.vars['type_L'])=="u":}}
					                                	['{{=T("Modified")}}',   {{=(100*float(roll[5]))/totalRoll}}],
					                                    ['{{=T("Out")}}',   {{=0/totalRoll}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totalRoll}}]
					                                {{elif str(request.vars['type_L'])=="d":}}
					                                	['{{=T("Modified")}}',   {{=0/totalRoll}}],
					                                    ['{{=T("Out")}}',   {{=(100*float(roll[5]))/totalRoll}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totalRoll}}]
					                                {{pass}}
					                                ]
					                            }]
					                        });
					                    });
					                </script>
		    			{{else:}}
		    				<h1>{{=T('No visible graphic')}}</h1>
		    			{{pass}}
		    			<br>
		    		</div>
				</div>
			</td>
		</tr>
		{{pass}}
		</table>
		<div align="right"> {{=T('Count')}} {{=T('Roles')}}: {{=pieGraphR}}</div>
    {{elif str(request.vars['level'])=="5":}}
    	<table class="table">
    		<tr>
    			<td>
			    	<div class="span10">
						<div class="span6">
			    			<a style="white-space:nowrap; cursor:pointer; align:right;" class="btn noPrint" href="{{=URL('management_reports', 'grades_management',vars=dict(list='level',level='4', period = str(request.vars['period']), month = str(request.vars['month']), project = str(request.vars['project']), type_L = str(request.vars['type_U']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}"><span class="icon-black icon-arrow-up"></span><b>{{=T('Level Up')}}</b></a>
				    		<br/><br/><br/>
				    		<strong>{{=T('Type')}}: </strong> {{=T('Grades Management')}}<br/>
				    		<strong>{{=T('Description')}}: </strong> {{=T('Report of transactions on the notes of students')}}<br/>
				    		<strong>{{=T('Period')}}: </strong> {{=infoLevel[0][0]}}<br/>
				    		<strong>{{=T('Month')}}: </strong> {{=infoLevel[0][1]}}<br/>
				    		<strong>{{=T('Project')}}: </strong> {{=infoLevel[0][2]}}<br/>
				    		<strong>{{=T('Role')}}: </strong> {{=infoLevel[0][3]}}<br/>
				    		<a class="noPrint" href="{{=URL('management_reports','grades_management_export', vars=dict(list_type='csv', level='5',period = str(request.vars['period']), month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), type_L = str(request.vars['type_L']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}" title="{{=T('Export reporting level')}}"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				    		<a class="btn noPrint" onclick="noPrint();"><i class="icon-print"></i></a>
						</div>
						<div class="span1 center"></div>
					    <div class="span5 center">
					    	<div style="width:100%; height:300px;" id="graphbars"></div>
					    	<script type="text/javascript">
			                    $(function () {
			                        $('#graphbars').highcharts({
			                            chart: {
			                                type: 'column',
			                                margin: [ 50, 50, 100, 80]
			                            },
			                            title: {
			                                text: '{{=T("Operations on the notes by user")}}'
			                            },
			                            xAxis: {
			                                categories: [
			                                	{{for userP in infoLevel:}}
			                                	'{{=userP[5]}}',
			                                	{{pass}}
			                                ],
			                                labels: {
			                                    rotation: -45,
			                                    align: 'right',
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif'
			                                    }
			                                }
			                            },
			                            yAxis: {
			                                min: 0,
			                                title: {
			                                    text: '{{=T("Operations")}}'
			                                }
			                            },
			                            legend: {
			                                enabled: false
			                            },
			                            tooltip: {
			                                pointFormat: '{{=T("Operations")}}: <b>{point.y:.1f}</b>',
			                            },
			                            series: [{
			                                name: '{{=T("Operations")}}',
			                                data: [
			                                       	{{for userP in infoLevel:}}
			                                       		{{if str(request.vars['type_L'])=="all":}}
										    				{{=int(userP[6])+int(userP[7])+int(userP[8])}},
										    			{{else:}}
										    				{{=int(userP[6])}},
										    			{{pass}}
				                                	{{pass}}
			                                       ],
			                                dataLabels: {
			                                    enabled: true,
			                                    rotation: -90,
			                                    color: '#FFFFFF',
			                                    align: 'right',
			                                    x: 4,
			                                    y: 10,
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif',
			                                        textShadow: '0 0 3px black'
			                                    }
			                                }
			                            }]
			                        });
			                    });
			                </script>
					    </div>
			    	</div>
				</td>
    		</tr>
    	</table>
    	<div class="navbar">
	      <div class="navbar-inner">
	      	<center><h1>
	      		<center><h1>{{=T('Detail')}}</h1></center>
	      	</h1></center>
	      	<a id="visibleAll" role="button" style="cursor:pointer;" class="pull-right"> 
	    		<span class="icon-black icon-plus-sign"></span>&nbsp;{{=T('Show All')}}
	    	</a>
	    	<a id="novisibleAll" role="button" style="cursor:pointer; display:none;" class="pull-right"> 
	    		<span class="icon-black icon-minus-sign"></span>&nbsp;{{=T('False')}} {{=T('Show All')}}
	    	</a>
	      </div>
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<h1>{{=T('Detail')}}</h1>
	  	</div>
    	<table class="table table-striped table-bordered">
		{{pieGraphU=0}}
		{{for userP in infoLevel:}}
		{{pieGraphU+=1}}
		{{if str(request.vars['type_L'])=="all":
			totaluserP=float(int(userP[6])+int(userP[7])+int(userP[8]))
		else:
			totaluserP=float(int(userP[6]))
		pass}}
		{{if totaluserP>float(0):}}
			<tr>
		{{else:}}
			<tr class="noVisible" style="display:none;">
		{{pass}}
			<td>
				<h1><small>{{=userP[5]}}</small></h1>
				<div class="span10" align="center">
					<div class="span6">
						<table class="table table-striped table-bordered">
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="i":}}
							<tr>
								<th><center>{{=T('Total inserted')}}</center></th>
								<td>
									<center><a class="badge badge-success noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll = str(request.vars['roll']), userP=userP[4], level='6', type_U = str(request.vars['type_L']), type_L = 'i', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=userP[6]
										else:
											=userP[6]
										pass
										}}
									</a>
									<a class="badge badge-success yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=userP[6]
										else:
											=userP[6]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="u":}}
							<tr>
								<th><center>{{=T('Total modified')}}</center></th>
								<td>
									<center><a class="badge badge-info noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll = str(request.vars['roll']), userP=userP[4], level='6', type_U = str(request.vars['type_L']), type_L = 'u', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=userP[7]
										else:
											=userP[6]
										pass
										}}
									</a>
									<a class="badge badge-info yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=userP[7]
										else:
											=userP[6]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
							{{if str(request.vars['type_L'])=="all" or str(request.vars['type_L'])=="d":}}
							<tr>
								<th><center>{{=T('Total out')}}</center></th>
								<td>
									<center><a class="badge badge-important noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll = str(request.vars['roll']), userP=userP[4], level='6', type_U = str(request.vars['type_L']), type_L = 'd', querySearch=personal_query))}}">
										{{if str(request.vars['type_L'])=="all":
											=userP[8]
										else:
											=userP[6]
										pass
										}}
									</a>
									<a class="badge badge-important yesPrint" style="white-space:nowrap; display:none">
										{{if str(request.vars['type_L'])=="all":
											=userP[8]
										else:
											=userP[6]
										pass
										}}
									</a></center>
								</td>
							</tr>
							{{pass}}
						</table>
						<center>
							<a class="btn noPrint" style="white-space:nowrap;" href="{{=URL('management_reports', 'grades_management',vars=dict(period = str(request.vars['period']), month= str(request.vars['month']), project= str(request.vars['project']), roll = str(request.vars['roll']), userP=userP[4], level='6', type_U = str(request.vars['type_L']), type_L = 'all', querySearch=personal_query))}}"><b>{{=T('See')}} {{=T('Area Level')}} </b><span class="icon-black icon-arrow-right"></span></a>
						</center>
						<br><br>
		    		</div>
		    		<div class="span1 center"></div>
		    		<div class="span5 center">
		    			{{if totaluserP>float(0):}}
		    				<div style="width:100%; height:300px;" id="graphpie{{=pieGraphU}}"></div>
		    				<script type="text/javascript">
					                    $(function () {
					                        $('#graphpie{{=pieGraphU}}').highcharts({
					                            chart: {
					                                plotBackgroundColor: null,
					                                plotBorderWidth: null,
					                                plotShadow: false
					                            },
					                            title: {
					                                text: '{{=T("Operations on academic grades")}}'
					                            },
					                            tooltip: {
					                                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					                            },
					                            plotOptions: {
					                                pie: {
					                                    allowPointSelect: true,
					                                    cursor: 'pointer',
					                                    dataLabels: {
					                                        enabled: true,
					                                        color: '#000000',
					                                        connectorColor: '#000000',
					                                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
					                                    }
					                                }
					                            },
					                            series: [{
					                                type: 'pie',
					                                name: '{{=T("Percentage of operation")}}',
					                                data: [
					                                {{if str(request.vars['type_L'])=="all":}}
					                                	['{{=T("Modified")}}', {{=(100*float(userP[7]))/totaluserP}}],
					                                    ['{{=T("Out")}}', {{=(100*float(userP[8]))/totaluserP}}],
					                                    ['{{=T("Inserted")}}', {{=(100*float(userP[6]))/totaluserP}}]
					                                {{elif str(request.vars['type_L'])=="i":}}
					                                	['{{=T("Modified")}}',   {{=0/totaluserP}}],
					                                    ['{{=T("Out")}}',   {{=0/totaluserP}}],
					                                    ['{{=T("Inserted")}}',   {{=(100*float(userP[6]))/totaluserP}}]
					                                {{elif str(request.vars['type_L'])=="u":}}
					                                	['{{=T("Modified")}}',   {{=(100*float(userP[6]))/totaluserP}}],
					                                    ['{{=T("Out")}}',   {{=0/totaluserP}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totaluserP}}]
					                                {{elif str(request.vars['type_L'])=="d":}}
					                                	['{{=T("Modified")}}',   {{=0/totaluserP}}],
					                                    ['{{=T("Out")}}',   {{=(100*float(userP[6]))/totaluserP}}],
					                                    ['{{=T("Inserted")}}',   {{=0/totaluserP}}]
					                                {{pass}}
					                                ]
					                            }]
					                        });
					                    });
					                </script>
		    			{{else:}}
		    				<h1>{{=T('No visible graphic')}}</h1>
		    			{{pass}}
		    			<br>
		    		</div>
				</div>
			</td>
		</tr>
		{{pass}}
		</table>
		<div align="right"> {{=T('Count')}} {{=T('Users')}}: {{=pieGraphU}}</div>
    {{elif str(request.vars['level'])=="6":}}
    	<table class="table">
    		<tr>
    			<td>
			    	<div class="span10">
						<div class="span6">
			    			<a style="white-space:nowrap; cursor:pointer; align:right;" class="btn noPrint" href="{{=URL('management_reports', 'grades_management',vars=dict(list='level',level='5', period = str(request.vars['period']), month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), type_L = str(request.vars['type_U']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}"><span class="icon-black icon-arrow-up"></span><b>{{=T('Level Up')}}</b></a>
				    		<br/><br/><br/>
				    		<strong>{{=T('Type')}}: </strong> {{=T('Grades Management')}}<br/>
				    		<strong>{{=T('Description')}}: </strong> {{=T('Report of transactions on the notes of students')}}<br/>
				    		<strong>{{=T('Period')}}: </strong> {{=infoLevel[0][0]}}<br/>
				    		<strong>{{=T('Month')}}: </strong> {{=infoLevel[0][1]}} <br/>
				    		<strong>{{=T('Project')}}: </strong> {{=infoLevel[0][2]}}<br/>
				    		<strong>{{=T('Role')}}: </strong> {{=infoLevel[0][3]}}<br/>
				    		<strong>{{=T('User')}}: </strong> {{=infoLevel[0][4]}}<br/>
				    		<a class="noPrint" href="{{=URL('management_reports','grades_management_export', vars=dict(list_type='csv', level='6',period = str(request.vars['period']), month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), userP = str(request.vars['userP']), type_L = str(request.vars['type_L']), type_U = str(request.vars['type_U']), querySearch=personal_query))}}" title="{{=T('Export reporting level')}}"><img src="{{=URL('static','images')}}/icono_CSV.png"></a>
				    		<a class="btn noPrint" onclick="noPrint();"><i class="icon-print"></i></a>
						</div>
						<div class="span1 center"></div>
					    <div class="span5 center">
					    	<div style="width:100%; height:300px;" id="graphbars"></div>
					    	<script type="text/javascript">
			                    $(function () {
			                        $('#graphbars').highcharts({
			                            chart: {
			                                type: 'column',
			                                margin: [ 50, 50, 100, 80]
			                            },
			                            title: {
			                                text: '{{=T("TOP 5: categories more operations grades")}}'
			                            },
			                            xAxis: {
			                                categories: [
			                                	{{for top in top5:}}
			                                		'{{=top["grades_log.category"]}}',
			                                	{{pass}}
			                                ],
			                                labels: {
			                                    rotation: -45,
			                                    align: 'right',
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif'
			                                    }
			                                }
			                            },
			                            yAxis: {
			                                min: 0,
			                                title: {
			                                    text: '{{=T("Operations")}}'
			                                }
			                            },
			                            legend: {
			                                enabled: false
			                            },
			                            tooltip: {
			                                pointFormat: '{{=T("Operations")}}: <b>{point.y:.1f}</b>',
			                            },
			                            series: [{
			                                name: '{{=T("Operations")}}',
			                                data: [
			                                       	{{for top in top5:}}
			                                       		{{=top['COUNT(grades_log.id)']}},
				                                	{{pass}}
			                                       ],
			                                dataLabels: {
			                                    enabled: true,
			                                    rotation: -90,
			                                    color: '#FFFFFF',
			                                    align: 'right',
			                                    x: 4,
			                                    y: 10,
			                                    style: {
			                                        fontSize: '13px',
			                                        fontFamily: 'Verdana, sans-serif',
			                                        textShadow: '0 0 3px black'
			                                    }
			                                }
			                            }]
			                        });
			                    });
			                </script>
					    </div>
			    	</div>
				</td>
    		</tr>
    	</table>
    	<div class="navbar">
	      <div class="navbar-inner">
	      	<center><h1>
	      		<center><h1>{{=T('Detail')}}</h1></center>
	      	</h1></center>
	      </div>
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<h1>{{=T('Detail')}}</h1>
	  	</div>
	  	<div class="noPrint">
	  		{{=grid}}
	  	</div>
	  	<div class="yesPrint" style="display:none;">
	  		<table class="table table-striped table-bordered">
	    		<tr>
	    			<th>{{=T('Date')}} {{=T('Log')}}</th>
	    			<th>{{=T('Description')}} {{=T('Log')}}</th>
	    			<th>{{=T('Category')}}</th>
	    			<th>{{=T('Activity')}}</th>
	    			<th>{{=T('Student')}}</th>
	    			<th>{{=T('Before Grade')}}</th>
	    			<th>{{=T('Grade')}}</th>
	    		</tr>
			{{for operation in dataFinal:}}
			<tr>
				<td>{{=operation.date_log}}</td>
				<td>{{=operation.description}}</td>
				<td>{{=operation.category}}</td>
				<td>{{=operation.activity}}</td>
				<td>{{=operation.academic}}</td>
				<td>{{=operation.before_grade}}</td>
				<td>{{=operation.after_grade}}</td>
			</tr>
			{{pass}}
			</table>
	  	</div>
    {{pass}}
	</div>
    <!--REPORT CONTENTS-->
</div>

<script type="text/javascript">
	$(document).ready(function(){
		//HOME --- Buttons for execution or cancellation search
		$("#buildSearch").click(function(){
			$("#div_search").slideDown();
		});

		$("#cancelSearch").click(function(){
			{{if request.vars['level'] is None or str(request.vars['level'])=="1":}}
				window.location.href = "{{=URL('management_reports', 'grades_management')}}";
			{{elif str(request.vars['level'])=="2":}}
				window.location.href = "{{=URL(vars=dict(level = 2, period = request.vars['period'], type_L=request.vars['type_L']))}}";
			{{elif str(request.vars['level'])=="3":}}
				window.location.href = "{{=URL(vars=dict(level = 3, period = request.vars['period'], month = str(request.vars['month']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}";
			{{elif str(request.vars['level'])=="4":}}
				window.location.href = "{{=URL(vars=dict(level = 4, period = request.vars['period'], month = str(request.vars['month']), project = str(request.vars['project']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}";
			{{elif str(request.vars['level'])=="5":}}
				window.location.href = "{{=URL(vars=dict(level = 5, period = request.vars['period'], month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}";
			{{elif str(request.vars['level'])=="6":}}
				window.location.href = "{{=URL(vars=dict(level = 6, period = request.vars['period'], month = str(request.vars['month']), project = str(request.vars['project']), roll = str(request.vars['roll']), userP = str(request.vars['userP']), type_L=request.vars['type_L'], type_U=request.vars['type_U']))}}";
			{{pass}}
		});

		{{if str(request.vars['level'])=="6":}}
			$(".web2py_breadcrumbs").css("display", "none");
		{{pass}}
		//END --- Buttons for execution or cancellation search

		
		//HOME --- Buttons for building the query
		$("#closeSearch").click(function(){
			$("#div_search").slideUp();
		});

		$("#fieldSearch").change(function(){
			{{for fieldSearch in fsearch:}}
				{{optionSearch = 'optionSearch_'+fieldSearch[0]}}
				{{valuesSearch = 'value_'+fieldSearch[0]}}
				$("#{{=optionSearch}}").css("display", "none");
				$("#{{=valuesSearch}}").css("display", "none");
				if (document.getElementById('fieldSearch').value == 'grades_log.{{=str(fieldSearch[0])}}'){
					$("#{{=optionSearch}}").css("display", "block");
					$("#{{=valuesSearch}}").css("display", "block");
				}
			{{pass}}
		});


		$("#newSearch").click(function(){
			{{for fieldSearch in fsearch:}}
				{{optionSearch = 'optionSearch_'+fieldSearch[0]}}
				{{valuesSearch = 'value_'+fieldSearch[0]}}
				if (document.getElementById('fieldSearch').value == 'grades_log.{{=str(fieldSearch[0])}}'){
					document.getElementById('querySearch').value = document.getElementById('fieldSearch').value+ ' '+ document.getElementById('{{=optionSearch}}').value +' "' +document.getElementById('{{=valuesSearch}}').value+'"';
				}
			{{pass}}
		});

		$("#andSearch").click(function(){
			{{for fieldSearch in fsearch:}}
				{{optionSearch = 'optionSearch_'+fieldSearch[0]}}
				{{valuesSearch = 'value_'+fieldSearch[0]}}
				if (document.getElementById('fieldSearch').value == 'grades_log.{{=str(fieldSearch[0])}}'){
					if (document.getElementById('querySearch').value==''){
						document.getElementById('querySearch').value = document.getElementById('fieldSearch').value+ ' '+ document.getElementById('{{=optionSearch}}').value +' "' +document.getElementById('{{=valuesSearch}}').value+'"';
					}else{
						document.getElementById('querySearch').value = document.getElementById('querySearch').value +" and "+ document.getElementById('fieldSearch').value+ ' '+ document.getElementById('{{=optionSearch}}').value +' "' +document.getElementById('{{=valuesSearch}}').value+'"';
					}
				}
			{{pass}}
		});

		$("#orSearch").click(function(){
			{{for fieldSearch in fsearch:}}
				{{optionSearch = 'optionSearch_'+fieldSearch[0]}}
				{{valuesSearch = 'value_'+fieldSearch[0]}}
				if (document.getElementById('fieldSearch').value == 'grades_log.{{=str(fieldSearch[0])}}'){
					if (document.getElementById('querySearch').value==''){
						document.getElementById('querySearch').value = document.getElementById('fieldSearch').value+ ' '+ document.getElementById('{{=optionSearch}}').value +' "' +document.getElementById('{{=valuesSearch}}').value+'"';
					}else{
						document.getElementById('querySearch').value = document.getElementById('querySearch').value +" or "+ document.getElementById('fieldSearch').value+ ' '+ document.getElementById('{{=optionSearch}}').value +' "' +document.getElementById('{{=valuesSearch}}').value+'"';
					}
				}
			{{pass}}
		});
		//END --- Buttons for query construction

		$("#visibleAll").click(function(){
			$(".noVisible").css("display", "");
			$("#visibleAll").css("display", "none");
			$("#novisibleAll").css("display", "");
		});
		$("#novisibleAll").click(function(){
			$(".noVisible").css("display", "none");
			$("#visibleAll").css("display", "");
			$("#novisibleAll").css("display", "none");
		});
	});

	function noPrint(){
		$(".noPrint").css("display", "none");
		$(".yesPrint").css("display", "");
		window.print();
		$(".noPrint").css("display", "");
		$(".yesPrint").css("display", "none");
	}
</script>