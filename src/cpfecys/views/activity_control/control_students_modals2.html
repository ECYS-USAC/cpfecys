<!--Create Activity Modal -->
<div id="createActivity" > 
    <div>
      <center>
        <h3>          
            {{if request.vars['type'] == "class":}}
              <h2><small>{{=T('Class Scheduler')}} - {{=name}}</small></h2>
            {{else:}}
              <h2><small>{{=T('Laboratory Scheduler')}} - {{=name}}</small></h2>
            {{pass}}
          
        </h3>
      </center>
    </div>
    <div id="actions_activity"  style="overflow:auto; height:100%; width:100%;">
      <form action="" enctype="multipart/form-data" method="post" >
        <center>
          <table >
              <tr>
                <td align="left">                	
                  <div align="center" id="activityDiv" value="activityDiv" class="well span12" style="overflow:auto;  width:300px;">    
                    
                  </div>
                   <div align="right">
                    <a id="activityButton" href="#information_text" role="button" class="btn btn-info"  
                    title="{{=T('Add activity to scheduler')}}"> 
                    <span class="icon-plus-sign"></span>
                    {{=T('Add Activity')}}
                     </a>
                  </div>
                  
                </td>
                <td align="left">
                  <div class="well span11" id="div_activity_show" style="width:1000px">
            	      
                  </div>
              	</td>
              </tr>
              
          </table>
			   </center>     	
        </div>

        <div align="center">

      </div>
    </form>
  </div>
</div>
  <!--Finish Create Activity Modal -->

  <script type="text/javascript">
  $(document).ready(function(){
    //Create
    $("#div_activity_show").load("{{=URL('activity_control','activity.html')}}?op=showTable&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}&amp;type={{=request.vars['type']}}"); 
    $("#activityDiv").load("{{=URL('activity_control','activity.html')}}?op=showInsert&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}&amp;type={{=request.vars['type']}}"); 

    $("#activityButton").click(function(){
        var category_activity_id_var = document.getElementById('category_activity_id').value;
        var activity_name2_var = document.getElementById('activity_name2').value;
        var activity_name1_var = document.getElementById('activity_name1').value;
        var activity_description_var = document.getElementById('activity_description').value;
        var field_grade_var = document.getElementById('field_grade').value;
        var dateInit_var = document.getElementById('dateInit').value;
        var dateEnd_var = document.getElementById('dateEnd').value;
        try{
          var TPA_var = document.getElementById('TP_check_activity').checked;  
        }catch(err){
          var TPA_var = false;
        }
        if(category_activity_id_var=="" || (activity_name1_var=="" && activity_name2_var=="") || activity_description_var=="" || dateInit_var=="" || dateEnd_var==""){
            alert("{{=T('Fill all fields to save.')}}");
        }else{
          var formatDate = /^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})$/;
          var validDateInit = dateInit_var.match(formatDate);
          var validDateEnd = dateEnd_var.match(formatDate);
          if (validDateInit == null || validDateEnd==null) {
            alert("{{=T('Enter date and time as YYYY-MM-DD or YYYY/MM/DD')}}");
          }else{
            if(dateInit_var<=dateEnd_var){
              if (field_grade_var!='nada'){
                var regex = /^\d+(?:\.\d{0,2})$/;
                var regex2 = /^([0-9])*$/;
                if (!regex.test(field_grade_var) && !regex2.test(field_grade_var)){
                  alert("{{=T('The entered value is not a decimal')}}");  
                }else{
                  if(field_grade_var=='0'){
                    alert("{{=T('The grade can not be 0')}}");
                  }else{
                    if (activity_name2_var==""){
                      $("#div_activity_show").load("{{=URL('activity_control','activity.html')}}?op=addActivity&amp;category_activity_id_var=" + category_activity_id_var + "&amp;activity_name1_var=" + encodeURIComponent(activity_name1_var) +"&amp;activity_description_var=" + encodeURIComponent(activity_description_var) + "&amp;field_grade_var=" + field_grade_var + "&amp;TPA_var=" + TPA_var + "&amp;dateInit_var="+encodeURIComponent(dateInit_var)+ "&amp;dateEnd_var="+encodeURIComponent(dateEnd_var)+"&amp;type={{=request.vars['type']}}&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}"); 
                    }else{
                      $("#div_activity_show").load("{{=URL('activity_control','activity.html')}}?op=addActivity&amp;category_activity_id_var=" + category_activity_id_var + "&amp;activity_name1_var=" + encodeURIComponent(activity_name2_var) +"&amp;activity_description_var=" + encodeURIComponent(activity_description_var) + "&amp;field_grade_var=" + field_grade_var + "&amp;TPA_var=" + TPA_var + "&amp;dateInit_var="+encodeURIComponent(dateInit_var)+ "&amp;dateEnd_var="+encodeURIComponent(dateEnd_var)+"&amp;type={{=request.vars['type']}}&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}"); 
                    }
                    $("#activityDiv").load("{{=URL('activity_control','activity.html')}}?op=showInsert&amp;type={{=request.vars['type']}}&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}");
                  }
                }
              }else{
                if (activity_name2_var==""){
                    $("#div_activity_show").load("{{=URL('activity_control','activity.html')}}?op=addActivity&amp;category_activity_id_var=" + category_activity_id_var + "&amp;activity_name1_var=" + encodeURIComponent(activity_name1_var) +"&amp;activity_description_var=" + encodeURIComponent(activity_description_var) + "&amp;field_grade_var=nada&amp;TPA_var=" + TPA_var + "&amp;dateInit_var="+encodeURIComponent(dateInit_var)+ "&amp;dateEnd_var="+encodeURIComponent(dateEnd_var)+"&amp;type={{=request.vars['type']}}&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}"); 
                  }else{
                    $("#div_activity_show").load("{{=URL('activity_control','activity.html')}}?op=addActivity&amp;category_activity_id_var=" + category_activity_id_var + "&amp;activity_name1_var=" + encodeURIComponent(activity_name2_var) +"&amp;activity_description_var=" + encodeURIComponent(activity_description_var) + "&amp;field_grade_var=nada&amp;TPA_var=" + TPA_var + "&amp;dateInit_var="+encodeURIComponent(dateInit_var)+ "&amp;dateEnd_var="+encodeURIComponent(dateEnd_var)+"&amp;type={{=request.vars['type']}}&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}"); 
                  }
                $("#activityDiv").load("{{=URL('activity_control','activity.html')}}?op=showInsert&amp;type={{=request.vars['type']}}&amp;project={{=request.vars['project']}}&amp;year={{=request.vars['year']}}"); 
              }
            }else{
              alert("{{=T('The end date must be greater than start date')}}");
            }
          }
        }
    })
  });

  </script>