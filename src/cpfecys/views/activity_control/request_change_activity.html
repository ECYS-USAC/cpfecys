{{extend 'template.html'}}
{{project_var = db(db.user_project.id == assignation).select().first()}}
<h2>
	{{=T('Laboratory Scheduler')}} - {{=T('Change Request')}}
	<br>
    <small>{{=name}} - {{=T(semester)}}, {{=year}}</small>
</h2>
<div class="row-fluid">
    <div class="well span12" style="overflow:auto; width:120%">
		<div>
			<a class="btn" href="{{=URL('activity_control', 'students_control', vars=dict(project = request.vars['project'], year = request.vars['year']))}}">
				<i class="icon-arrow-left"></i>{{=T('Back')}}
			</a>
		</div>
		<br>
		<div id="contentSuper">
			<div align="center" id="controlActivity">
				<ul id="myTab" class="nav nav-tabs">
					<li class="active" id="var_requestDone"><a href="#">{{=T('Pending requests')}}</a></li>
					<li id="var_requestCreate"><a href="#">{{=T('Create Request')}}</a></li>
				</ul>
				<div id="content">
					<div class="well span11" id="div_request_show">
        				<table class="table table-striped table-bordered">
							<tr>
								<th>{{=T('User')}}</th>
								<th>{{=T('Role')}} </th>
								<th>{{=T('Status')}}</th>
								<th>{{=T('Date Request')}}</th>
								<th>{{=T('Action')}}</th>
							</tr>
						{{for change in db((db.requestchange_activity.status=='Pending')&(db.requestchange_activity.semester==int(semestre2.id))&(db.requestchange_activity.course==int(project_var.project))).select():}}
							<tr>
								<td>{{=change.user_name}}</td>
								<td>{{=T(change.roll)}}</td>
								<td>{{=T(change.status)}}</td>
								<td>{{=change.date_request}}</td>
								<td>
									<a class="btn" title="{{=T('View the change request')}}" onclick="detail({{=change.id}});">{{=T('Detail')}}</a>
								</td>
							</tr>
						{{pass}}
						</table>
                  	</div>
                  	<div class="well span11" id="div_request_detail" style="display: none;">
                  	</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
	function detail(var_id){
		$("#div_request_show").css("display", "none");
		$("#div_request_detail").css("display", "block");
		$("#div_request_detail").load("{{=URL('activity_control','activityRequest.html')}}?op=solveActivityRequestDetail&amp;Idrequest="+var_id); 
	}
</script>